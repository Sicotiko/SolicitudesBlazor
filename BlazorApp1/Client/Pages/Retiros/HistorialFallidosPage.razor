@page "/Fallidos"
@using BlazorApp1.Shared.Excepciones;
@using BlazorApp1.Shared.User
@using BlazorApp1.Shared.ViewModel

@inject NavigationManager navigation
@inject Usuario user
@inject ListadoTipoMovil listadoMovilesDisponibles
@inject MovilesService MovilesRepo
@inject NotificationService NotifyRepo

<HistorialFallidos />

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            user.GetCredentials();
            try
            {
                listadoMovilesDisponibles.TipoMoviles = await MovilesRepo.GetMovilesDisponibles();
            }
            catch (ExceptionResponse exRes)
            {
                this.NotifyRepo.Notify(NotificationSeverity.Error, "Error!", exRes.Message);
            }
        }
        catch
        {
            navigation.NavigateTo("/Configuracion");
        }
    }

}
